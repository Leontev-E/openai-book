<!doctype html><meta charset="utf-8">
<link rel="stylesheet" href="/cookbook-assets/all.css"><title>How to run gpt-oss-20b on Google Colab</title><article><div class="flex flex-col items-center pt-8 pb-32 px-4 sm:px-8"><div class="w-full"><div class="w-full"><div class="mx-auto max-w-3xl px-4 sm:px-8"><div class="mb-12 mt-4"><h3 class="text-sm text-gray-500 mb-2 sm:mb-8 text-center">Aug 6, 2025</h3><h1 class="text-xl sm:text-4xl font-bold mb-12 sm:mb-16 text-center">How to run gpt-oss-20b on Google Colab</h1><div class="flex justify-between items-end"><div class="flex space-x-2 items-center"><div class="flex"><button class="transform transition-all cursor-pointer ml-0" style="z-index:2" rel="noopener noreferrer" aria-label="View profile of pcuenca"><div class="relative rounded-full h-8 w-8 bg-white"><div class="rounded-full h-8 w-8 bg-gray-300 flex items-center justify-center text-white text-sm  border-white border-2">PC</div></div></button><button class="transform transition-all cursor-pointer -ml-2" style="z-index:1" rel="noopener noreferrer" aria-label="View profile of Vaibhavs10"><div class="relative rounded-full h-8 w-8 bg-white"><div class="rounded-full h-8 w-8 bg-gray-300 flex items-center justify-center text-white text-sm  border-white border-2">V</div></div></button></div><div class="flex flex-col justify-center"><div><span class="text-sm text-primary"><button aria-label="View profile of pcuenca" rel="noopener noreferrer">Pedro Cuenca</button>, <button aria-label="View profile of Vaibhavs10" rel="noopener noreferrer">vb</button></span></div></div></div><div class="flex flex-row gap-x-0"><a href="https://github.com/openai/openai-cookbook/blob/main/articles/gpt-oss/run-colab.ipynb" target="_blank" rel="noopener noreferrer" class="text-sm rounded py-2 px-2 sm:px-3 hover:bg-muted transition-colors flex gap-2 items-center"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><path d="M7.49933 0.25C3.49635 0.25 0.25 3.49593 0.25 7.50024C0.25 10.703 2.32715 13.4206 5.2081 14.3797C5.57084 14.446 5.70302 14.2222 5.70302 14.0299C5.70302 13.8576 5.69679 13.4019 5.69323 12.797C3.67661 13.235 3.25112 11.825 3.25112 11.825C2.92132 10.9874 2.44599 10.7644 2.44599 10.7644C1.78773 10.3149 2.49584 10.3238 2.49584 10.3238C3.22353 10.375 3.60629 11.0711 3.60629 11.0711C4.25298 12.1788 5.30335 11.8588 5.71638 11.6732C5.78225 11.205 5.96962 10.8854 6.17658 10.7043C4.56675 10.5209 2.87415 9.89918 2.87415 7.12104C2.87415 6.32925 3.15677 5.68257 3.62053 5.17563C3.54576 4.99226 3.29697 4.25521 3.69174 3.25691C3.69174 3.25691 4.30015 3.06196 5.68522 3.99973C6.26337 3.83906 6.8838 3.75895 7.50022 3.75583C8.1162 3.75895 8.73619 3.83906 9.31523 3.99973C10.6994 3.06196 11.3069 3.25691 11.3069 3.25691C11.7026 4.25521 11.4538 4.99226 11.3795 5.17563C11.8441 5.68257 12.1245 6.32925 12.1245 7.12104C12.1245 9.9063 10.4292 10.5192 8.81452 10.6985C9.07444 10.9224 9.30633 11.3648 9.30633 12.0413C9.30633 13.0102 9.29742 13.7922 9.29742 14.0299C9.29742 14.2239 9.42828 14.4496 9.79591 14.3788C12.6746 13.4179 14.75 10.7025 14.75 7.50024C14.75 3.49593 11.5036 0.25 7.49933 0.25Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg><span class="max-sm:hidden">Open in GitHub</span></a><a href="https://nbviewer.org/format/script/github/openai/openai-cookbook/blob/main/articles/gpt-oss/run-colab.ipynb" class="text-sm rounded py-2 px-2 sm:px-3 hover:bg-muted transition-colors flex gap-2 items-center" target="_blank" rel="noopener noreferrer"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><path d="M3 2.5C3 2.22386 3.22386 2 3.5 2H9.08579C9.21839 2 9.34557 2.05268 9.43934 2.14645L11.8536 4.56066C11.9473 4.65443 12 4.78161 12 4.91421V12.5C12 12.7761 11.7761 13 11.5 13H3.5C3.22386 13 3 12.7761 3 12.5V2.5ZM3.5 1C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H11.5C12.3284 14 13 13.3284 13 12.5V4.91421C13 4.51639 12.842 4.13486 12.5607 3.85355L10.1464 1.43934C9.86514 1.15804 9.48361 1 9.08579 1H3.5ZM4.5 4C4.22386 4 4 4.22386 4 4.5C4 4.77614 4.22386 5 4.5 5H7.5C7.77614 5 8 4.77614 8 4.5C8 4.22386 7.77614 4 7.5 4H4.5ZM4.5 7C4.22386 7 4 7.22386 4 7.5C4 7.77614 4.22386 8 4.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H4.5ZM4.5 10C4.22386 10 4 10.2239 4 10.5C4 10.7761 4.22386 11 4.5 11H10.5C10.7761 11 11 10.7761 11 10.5C11 10.2239 10.7761 10 10.5 10H4.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg><span class="max-sm:hidden">View as Markdown</span></a></div></div></div></div><div id="content" class="w-full"><div class="w-full px-6 lg:px-8"><div class="grid grid-cols-1 lg:grid-cols-[clamp(12rem,20vw,18rem)_minmax(0,1fr)] gap-14"><div class="mx-auto w-full max-w-[clamp(60ch,72vw,90ch)] px-4 sm:px-8"><div class="flex flex-col space-y-6"><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><p><a href="https://colab.research.google.com/github/openai/openai-cookbook/blob/main/articles/gpt-oss/run-colab.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab"></a></p></article><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h1 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="run-openai-gpt-oss-20b-in-a-free-google-colab"><a class="heading-link" href="#run-openai-gpt-oss-20b-in-a-free-google-colab">Run OpenAI gpt-oss 20B in a FREE Google Colab</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h1>
<p>OpenAI released <code>gpt-oss</code> <a href="https://hf.co/openai/gpt-oss-120b">120B</a> and <a href="https://hf.co/openai/gpt-oss-20b">20B</a>. Both models are Apache 2.0 licensed.</p>
<p>Specifically, <code>gpt-oss-20b</code> was made for lower latency and local or specialized use cases (21B parameters with 3.6B active parameters).</p>
<p>Since the models were trained in native MXFP4 quantization it makes it easy to run the 20B even in resource constrained environments like Google Colab.</p>
<p>Authored by: <a href="https://huggingface.co/pcuenq">Pedro</a> and <a href="https://huggingface.co/reach-vb">VB</a></p></article><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h2 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="setup-environment"><a class="heading-link" href="#setup-environment">Setup environment</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h2></article><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><p>Since support for mxfp4 in transformers is bleeding edge, we need a recent version of PyTorch and CUDA, in order to be able to install the <code>mxfp4</code> triton kernels.</p>
<p>We also need to install transformers from source, and we uninstall <code>torchvision</code> and <code>torchaudio</code> to remove dependency conflicts.</p></article><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #FDAEB7; font-style: italic">!</span><span style="color: #E1E4E8">pip install </span><span style="color: #F97583">-</span><span style="color: #E1E4E8">q </span><span style="color: #FDAEB7; font-style: italic">--</span><span style="color: #E1E4E8">upgrade torch</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #FDAEB7; font-style: italic">!</span><span style="color: #E1E4E8">pip install </span><span style="color: #F97583">-</span><span style="color: #E1E4E8">q transformers triton</span><span style="color: #F97583">==</span><span style="color: #79B8FF">3.4</span><span style="color: #E1E4E8"> kernels</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #FDAEB7; font-style: italic">!</span><span style="color: #E1E4E8">pip uninstall </span><span style="color: #F97583">-</span><span style="color: #E1E4E8">q torchvision torchaudio </span><span style="color: #F97583">-</span><span style="color: #E1E4E8">y</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><p>Please, restart your Colab runtime session after installing the packages above.</p></article><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h2 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="load-the-model-from-hugging-face-in-google-colab"><a class="heading-link" href="#load-the-model-from-hugging-face-in-google-colab">Load the model from Hugging Face in Google Colab</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h2>
<p>We load the model from here: <a href="https://hf.co/openai/gpt-oss-20b">openai/gpt-oss-20b</a></p></article><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #F97583">from</span><span style="color: #E1E4E8"> transformers </span><span style="color: #F97583">import</span><span style="color: #E1E4E8"> AutoModelForCausalLM, AutoTokenizer</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">model_id </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"openai/gpt-oss-20b"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">tokenizer </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> AutoTokenizer.from_pretrained(model_id)</span></span>
<span class="line"><span style="color: #E1E4E8">model </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> AutoModelForCausalLM.from_pretrained(</span></span>
<span class="line"><span style="color: #E1E4E8">    model_id,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">torch_dtype</span><span style="color: #F97583">=</span><span style="color: #9ECBFF">"auto"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">device_map</span><span style="color: #F97583">=</span><span style="color: #9ECBFF">"cuda"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">)</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h2 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="setup-messages-chat"><a class="heading-link" href="#setup-messages-chat">Setup messages/ chat</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h2>
<p>You can provide an optional system prompt or directly the input.</p></article><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">messages </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> [</span></span>
<span class="line"><span style="color: #E1E4E8">    {</span><span style="color: #9ECBFF">"role"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"system"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">"content"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"Always respond in riddles"</span><span style="color: #E1E4E8">},</span></span>
<span class="line"><span style="color: #E1E4E8">    {</span><span style="color: #9ECBFF">"role"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"user"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">"content"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"What is the weather like in Madrid?"</span><span style="color: #E1E4E8">},</span></span>
<span class="line"><span style="color: #E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">inputs </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> tokenizer.apply_chat_template(</span></span>
<span class="line"><span style="color: #E1E4E8">    messages,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">add_generation_prompt</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">return_tensors</span><span style="color: #F97583">=</span><span style="color: #9ECBFF">"pt"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">return_dict</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">).to(model.device)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">generated </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> model.generate(</span><span style="color: #F97583">**</span><span style="color: #E1E4E8">inputs, </span><span style="color: #FFAB70">max_new_tokens</span><span style="color: #F97583">=</span><span style="color: #79B8FF">500</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #79B8FF">print</span><span style="color: #E1E4E8">(tokenizer.decode(generated[</span><span style="color: #79B8FF">0</span><span style="color: #E1E4E8">][inputs[</span><span style="color: #9ECBFF">"input_ids"</span><span style="color: #E1E4E8">].shape[</span><span style="color: #F97583">-</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">]:]))</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h2 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="specify-reasoning-effort"><a class="heading-link" href="#specify-reasoning-effort">Specify Reasoning Effort</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h2></article><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><p>Simply pass it as an additional argument to <code>apply_chat_template()</code>. Supported values are <code>"low"</code>, <code>"medium"</code> (default), or <code>"high"</code>.</p></article><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">messages </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> [</span></span>
<span class="line"><span style="color: #E1E4E8">    {</span><span style="color: #9ECBFF">"role"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"system"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">"content"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"Always respond in riddles"</span><span style="color: #E1E4E8">},</span></span>
<span class="line"><span style="color: #E1E4E8">    {</span><span style="color: #9ECBFF">"role"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"user"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">"content"</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">"Explain why the meaning of life is 42"</span><span style="color: #E1E4E8">},</span></span>
<span class="line"><span style="color: #E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">inputs </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> tokenizer.apply_chat_template(</span></span>
<span class="line"><span style="color: #E1E4E8">    messages,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">add_generation_prompt</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">return_tensors</span><span style="color: #F97583">=</span><span style="color: #9ECBFF">"pt"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">return_dict</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">    </span><span style="color: #FFAB70">reasoning_effort</span><span style="color: #F97583">=</span><span style="color: #9ECBFF">"high"</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">).to(model.device)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">generated </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> model.generate(</span><span style="color: #F97583">**</span><span style="color: #E1E4E8">inputs, </span><span style="color: #FFAB70">max_new_tokens</span><span style="color: #F97583">=</span><span style="color: #79B8FF">500</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #79B8FF">print</span><span style="color: #E1E4E8">(tokenizer.decode(generated[</span><span style="color: #79B8FF">0</span><span style="color: #E1E4E8">][inputs[</span><span style="color: #9ECBFF">"input_ids"</span><span style="color: #E1E4E8">].shape[</span><span style="color: #F97583">-</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">]:]))</span></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div><article class="prose prose-sm sm:prose-base max-w-none dark:prose-invert"><h2 class="
        group 
        relative 
        cursor-pointer
        scroll-mt-24 
      " id="try-out-other-prompts-and-ideas"><a class="heading-link" href="#try-out-other-prompts-and-ideas">Try out other prompts and ideas!</a><button class=" absolute  top-1/2  -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out text-[var(--oai-green)] hover:text-[var(--oai-green-hover)] p-1 pl-3 pointer-events-none group-hover:pointer-events-auto " aria-label="Copy link to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></button><div id="_rht_toaster" style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></h2>
<p>Check out our blogpost for other ideas: <a href="https://hf.co/blog/welcome-openai-gpt-oss">https://hf.co/blog/welcome-openai-gpt-oss</a></p></article><div><div class="relative"><div class="[&amp;&gt;*]:rounded-md [&amp;&gt;*]:p-4 [&amp;&gt;*]:text-xs [&amp;&gt;*]:overflow-x-auto"><pre class="shiki github-dark" style="background-color: #24292e" tabindex="0"><code><span class="line"></span></code></pre></div><button class="rounded p-1.5 hover:bg-muted/10 transition-all absolute top-2 right-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 stroke-1 stroke-gray-200"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div></div></div></div></div></div></div></div></div></div><next-route-announcer style="position: absolute;"></next-route-announcer></article>