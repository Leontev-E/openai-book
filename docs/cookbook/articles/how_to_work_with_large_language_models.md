---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, отображающие текст в текст. Получив входную строку текста, крупная языковая модель предсказывает текст, который должен следовать дальше.

Магия крупных языковых моделей заключается в том, что, будучи обученными минимизировать ошибку предсказания на огромных объёмах текста, модели в итоге изучают концепции, полезные для этих предсказаний. Например, они учатся:

- как правильно писать
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести беседу
- как писать на многих языках
- как программировать
- и т.д.

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно появляются в контексте с другими словами, и используют полученные знания для предсказания следующего наиболее вероятного слова, которое может появиться в ответе на запрос пользователя, а затем следующее за ним и так далее.

GPT-3 и GPT-4 работают в основе [многих программных продуктов][OpenAI Customer Stories], включая приложения для повышения продуктивности, образовательные приложения, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входных данных для крупной языковой модели самым влиятельным является текстовый запрос (prompt).

Крупные языковые модели можно заставить выдавать результат несколькими способами:

- **Инструкция**: Скажите модели, что вы хотите
- **Дополнение**: Побудите модель дополнить начало того, что вы хотите
- **Сценарий**: Задайте модели ситуацию для разыгрывания
- **Демонстрация**: Покажите модели, что вы хотите, с помощью:
  - Нескольких примеров в запросе
  - Сотен или тысяч примеров в обучающем наборе данных для дообучения

Пример каждого способа показан ниже.

### Инструкционные запросы

Напишите свою инструкцию в начале (или в конце, или в обоих местах) запроса, и модель сделает всё возможное, чтобы выполнить её, а затем остановится. Инструкции могут быть подробными, так что не стесняйтесь писать абзац с явным описанием желаемого результата, просто учитывайте максимальное количество [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them), которые модель может обработать.

Пример инструкционного запроса:

&lt;&lt;&lt;CODE_0>>>

Результат:

&lt;&lt;&lt;CODE_1>>>

### Пример запроса с дополнением

Запросы с дополнением используют то, как крупные языковые модели пытаются писать текст, который, по их мнению, наиболее вероятно появится следующим. Чтобы направить модель, попробуйте начать шаблон или предложение, которое модель дополнит в нужном вам направлении. По сравнению с прямыми инструкциями такой способ управления требует больше осторожности и экспериментов. Кроме того, модели не обязательно знают, когда остановиться, поэтому часто нужны последовательности остановки или пост-обработка, чтобы обрезать сгенерированный текст после желаемого результата.

Пример запроса с дополнением:

&lt;&lt;&lt;CODE_2>>>

Результат:

&lt;&lt;&lt;CODE_3>>>

### Пример запроса-сценария

Задание модели сценария или роли может быть полезно для сложных запросов или при поиске креативных ответов. Используя гипотетический запрос, вы задаёте ситуацию, проблему или историю, а затем просите модель ответить, как если бы она была персонажем в этом сценарии или экспертом по теме.

Пример запроса-сценария:

&lt;&lt;&lt;CODE_4>>>

Результат:

&lt;&lt;&lt;CODE_5>>>

### Пример демонстрационного запроса (few-shot learning)

Похожий на запросы с дополнением подход — демонстрации показывают модели, чего вы хотите добиться. Этот подход иногда называют обучением с малым количеством примеров, так как модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6>>>

Результат:

&lt;&lt;&lt;CODE_7>>>

### Пример запроса для дообученной модели

При достаточном количестве обучающих примеров можно [дообучить][Fine Tuning Docs] кастомную модель. В этом случае инструкции становятся ненужными, так как модель обучается выполнять задачу на предоставленных данных. Однако полезно включать разделители (например, &lt;&lt;&lt;INL_0>>>, &lt;&lt;&lt;INL_1>>>, или любые строки, которые редко встречаются во входных данных), чтобы указать модели, где заканчивается запрос и начинается ответ. Без таких разделителей модель рискует продолжить развёртывание входного текста, а не начать желаемый ответ.

Пример запроса для дообученной модели (обученной на парах запрос-дополнение):

&lt;&lt;&lt;CODE_8>>>

Результат:

&lt;&lt;&lt;CODE_9>>>

## Возможности работы с кодом

Крупные языковые модели хороши не только с текстом — они также отлично работают с кодом. Примером служит модель [GPT-4][GPT-4 and GPT-4 Turbo] от OpenAI.

GPT-4 лежит в основе [множества инновационных продуктов][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автозаполнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (помогает быстрее создавать ПО в редакторе, разработанном для совместного программирования с ИИ)

GPT-4 более продвинут, чем предыдущие модели, такие как &lt;&lt;&lt;INL_2>>>. Однако для достижения лучших результатов при работе с кодом важно давать чёткие и конкретные инструкции. В результате создание хороших запросов требует большей тщательности.

### Дополнительные советы по запросам

Для получения большего количества примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, входной запрос — лучший инструмент для улучшения результатов модели. Вы можете использовать такие приёмы, как:

- **Будьте конкретнее.** Например, если вам нужен список, разделённый запятыми, попросите вывести именно такой список. Если хотите, чтобы модель говорила «Я не знаю», когда ответа нет, скажите: «Ответь "Я не знаю", если не знаешь.» Чем точнее инструкции, тем лучше модель сможет отреагировать.
- **Предоставляйте контекст.** Помогайте модели понять общую картину вашего запроса. Это может быть фоновая информация, примеры или демонстрации того, что вы хотите, или объяснение цели задачи.
- **Попросите модель отвечать как эксперт.** Явное обращение с просьбой создать качественный ответ или ответить как эксперт может стимулировать модель генерировать более качественные ответы, которые, по её мнению, написал бы профессионал. Фразы типа «Объясни подробно» или «Опиши пошагово» могут быть эффективны.
- **Побуждайте модель записывать последовательность шагов с объяснением рассуждений.** Если важно понять «почему» ответа, попросите включить ход рассуждений. Это можно сделать, просто добавив строчку вроде «[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед каждым ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples  