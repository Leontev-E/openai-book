---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, которые отображают текст в текст. Получив на вход строку текста, крупная языковая модель предсказывает, какой текст должен идти далее.

Магия больших языковых моделей заключается в том, что, будучи обученными минимизировать ошибку предсказания на огромных объемах текста, модели в итоге изучают концепции, полезные для этих предсказаний. Например, они учатся:

- как правильно писать
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести беседу
- как писать на многих языках
- как программировать
- и так далее.

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно появляются в контексте с другими словами, и используют то, что выучили, чтобы предсказать следующее наиболее вероятное слово, которое может появиться в ответ на запрос пользователя, и каждое последующее слово после него.

GPT-3 и GPT-4 лежат в основе [многих программных продуктов][OpenAI Customer Stories], включая приложения для продуктивности, образовательные приложения, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входных данных для крупной языковой модели наиболее влиятельным является текстовый запрос (prompt).

Крупные языковые модели можно направлять на генерацию результата несколькими способами:

- **Инструкция**: Скажите модели, что вы хотите
- **Завершение**: Побудите модель дополнить начало того, что вы хотите
- **Сценарий**: Дайте модели ситуацию, которую нужно отыграть
- **Демонстрация**: Покажите модели, что вы хотите, используя:
  - Несколько примеров в запросе
  - Сотни или тысячи примеров в тренировочном наборе для тонкой настройки

Пример каждого из них приведён ниже.

### Запросы-инструкции

Напишите инструкцию в начале запроса (или в конце, или и там, и там), и модель постарается выполнить эту инструкцию, а затем прекратит вывод. Инструкции могут быть подробными, поэтому не бойтесь написать целый абзац, явно описывающий желаемый результат, но учитывайте, сколько [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) модель может обработать.

Пример запроса-инструкции:

&lt;&lt;&lt;CODE_0&gt;>>

Вывод:

&lt;&lt;&lt;CODE_1&gt;>>

### Пример запроса в стиле завершения

Запросы в стиле завершения используют то, что крупные языковые модели пытаются написать текст, который, по их мнению, наиболее вероятно идет дальше. Чтобы управлять моделью, попробуйте начать шаблон или предложение, которое будет дополнено желаемым выводом. По сравнению с прямыми инструкциями, такой способ управления моделями требует больше аккуратности и экспериментов. Кроме того, модели не всегда знают, где остановиться, поэтому часто нужны специальные стоп-последовательности или постобработка, чтобы обрезать текст, сгенерированный сверх желаемого результата.

Пример запроса в стиле завершения:

&lt;&lt;&lt;CODE_2&gt;>>

Вывод:

&lt;&lt;&lt;CODE_3&gt;>>

### Пример сценарного запроса

Задание модели сценария или роли для отыгрыша может быть полезным для сложных запросов или при поиске творческих ответов. Используя гипотетический запрос, вы создаёте ситуацию, проблему или историю, а затем просите модель ответить, как будто она персонаж в этом сценарии или эксперт по теме.

Пример сценарного запроса:

&lt;&lt;&lt;CODE_4&gt;>>

Вывод:

&lt;&lt;&lt;CODE_5&gt;>>

### Пример демонстрационного запроса (few-shot обучение)

Подобно запросам в стиле завершения, демонстрации показывают модели, что вы хотите, чтобы она сделала. Этот подход иногда называют few-shot обучением, так как модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6&gt;>>

Вывод:

&lt;&lt;&lt;CODE_7&gt;>>

### Пример тонко настроенного запроса

Имея достаточное количество учебных примеров, вы можете [тонко настроить][Fine Tuning Docs] свою модель. В таком случае инструкции становятся ненужными, так как модель может научиться задаче на основе предоставленных данных для обучения. Тем не менее, полезно включать разделители (например, `->` или `###` или любую строку, которая обычно не встречается во входных данных), чтобы указать модели, где заканчивается запрос и начинается вывод. Без разделителей есть риск, что модель будет продолжать развивать текст запроса, а не начнёт желаемый ответ.

Пример тонко настроенного запроса (для модели, обученной на похожих парах запрос-завершение):

&lt;&lt;&lt;CODE_8&gt;>>

Вывод:

&lt;&lt;&lt;CODE_9&gt;>>

## Возможности работы с кодом

Крупные языковые модели хороши не только с текстом — они могут отлично работать и с кодом. Отличный пример — модель OpenAI [GPT-4][GPT-4 and GPT-4 Turbo].

GPT-4 лежит в основе [множества инновационных продуктов][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автодополнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (позволяет быстрее создавать ПО в редакторе, разработанном для парного программирования с ИИ)

GPT-4 более продвинут, чем предыдущие модели, например `gpt-3.5-turbo-instruct`. Но для максимально эффективной работы с GPT-4 в задачах программирования важно давать чёткие и конкретные инструкции. В результате разработка хороших запросов требует больше внимания.

### Дополнительные советы по запросам

Для большего количества примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, входной запрос — лучший инструмент для улучшения вывода модели. Можно попробовать такие приёмы:

- **Будьте конкретнее** Например, если вы хотите вывести список через запятую, попросите вернуть список, разделённый запятыми. Если хотите, чтобы модель написала «Я не знаю», когда не знает ответа, скажите ей «Скажи "Я не знаю", если не знаешь ответа». Чем конкретнее ваши инструкции, тем лучше модель сможет ответить.
- **Дайте контекст**: Помогите модели понять общую картину вашего запроса. Это может быть фон, примеры или демонстрации того, что вы хотите, или объяснение цели вашей задачи.
- **Попросите модель отвечать, как эксперт.** Явная просьба выдавать высококачественные ответы или отвечать так, как если бы ответ писал эксперт, может заставить модель генерировать более качественные ответы. Фразы «Объясните подробно» или «Опишите шаг за шагом» часто эффективны.
- **Попросите модель выписать серию шагов с пояснением рассуждений.** Если важно понять «почему» за ответом, попросите модель включить свои рассуждения. Это можно сделать, просто добавив строку вроде «[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед каждым ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples