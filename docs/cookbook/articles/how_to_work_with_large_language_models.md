---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, которые сопоставляют текст с текстом. Получив входную строку текста, крупная языковая модель предсказывает, какой текст должен идти далее.

«Магия» крупных языковых моделей в том, что, обучаясь минимизировать ошибку предсказания на огромных массивах текста, модели в итоге выучивают концепции, полезные для этих предсказаний. Например, они учатся:

- как правильно писать
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести беседу
- как писать на многих языках
- как программировать
- и так далее

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно появляются в контексте с другими словами, и применяют выученное, чтобы предсказать следующее наиболее вероятное слово, которое может появиться в ответ на запрос пользователя, и каждое последующее слово после этого.

GPT-3 и GPT-4 используются во [многих программных продуктах][OpenAI Customer Stories], включая приложения для повышения производительности, образовательные приложения, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входных данных для крупной языковой модели самым влиятельным является текстовый запрос (prompt).

Крупные языковые модели можно побудить к созданию текста несколькими способами:

- **Инструкция**: Скажите модели, чего вы хотите
- **Завершение**: Побудите модель дополнить начало того, что вы хотите
- **Сценарий**: Задайте модели ситуацию для разыгрывания
- **Демонстрация**: Покажите модели, что вы хотите, с помощью:
  - Нескольких примеров в запросе
  - Сотен или тысяч примеров в датасете для дообучения

Пример каждого способа показан ниже.

### Примеры инструкционных запросов

Напишите вашу инструкцию в начале запроса (или в конце, или в обоих местах), и модель сделает всё возможное, чтобы следовать этой инструкции и затем остановится. Инструкции могут быть подробными, так что не бойтесь писать целый абзац, подробно уточняющий желаемый результат, но учитывайте, сколько [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) модель может обработать.

Пример инструкционного запроса:

&lt;&lt;&lt;FENCE_0>>>

Вывод:

&lt;&lt;&lt;FENCE_1>>>

### Пример запроса на завершение

Запросы в стиле завершения используют то, что крупные языковые модели пытаются писать текст, который, по их мнению, с наибольшей вероятностью идет следующим. Чтобы направить модель, попробуйте начать паттерн или предложение, которое будет завершено тем ответом, который вы хотите получить. По сравнению с прямыми инструкциями, такой способ управления моделями требует большей аккуратности и экспериментов. Кроме того, модели не всегда знают, когда остановиться, поэтому часто нужны стоп-последовательности или постобработка, чтобы обрезать текст после желаемого вывода.

Пример запроса на завершение:

&lt;&lt;&lt;FENCE_2>>>

Вывод:

&lt;&lt;&lt;FENCE_3>>>

### Пример сценарного запроса

Задание модели сценария для исполнения или роли может быть полезно при сложных запросах или при поиске творческих ответов. Используя гипотетический запрос, вы создаёте ситуацию, проблему или историю, а затем просите модель ответить так, будто она персонаж в этом сценарии или эксперт по данной теме.

Пример сценарного запроса:

&lt;&lt;&lt;FENCE_4>>>

Вывод:

&lt;&lt;&lt;FENCE_5>>>

### Пример демонстрационного запроса (обучение с малым числом примеров)

Похожий на стиль завершения, демонстрационный запрос показывает модели, что вы хотите, чтобы она сделала. Этот подход иногда называют обучением с малым числом примеров (few-shot learning), так как модель учится на основе нескольких предоставленных примеров в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;FENCE_6>>>

Вывод:

&lt;&lt;&lt;FENCE_7>>>

### Пример дообученного запроса

Имея достаточное количество обучающих примеров, можно [дообучить][Fine Tuning Docs] кастомную модель. В таком случае инструкции становятся ненужными, поскольку модель усваивает задачу по предоставленным обучающим данным. Тем не менее, полезно включать разделители (например, `->`, `###` или любую строку, которая редко встречается во входах), чтобы сообщить модели, когда запрос заканчивается и начинается ответ. Без разделителей модель может продолжить развёрнутый текст на вводе вместо того, чтобы начать желаемый ответ.

Пример дообученного запроса (для модели, дообученной на похожих парах запрос-ответ):

&lt;&lt;&lt;FENCE_8>>>

Вывод:

&lt;&lt;&lt;FENCE_9>>>

## Возможности работы с кодом

Крупные языковые модели хороши не только с текстом — они отлично подходят и для работы с кодом. Модель OpenAI [GPT-4][GPT-4 and GPT-4 Turbo] — яркий пример.

GPT-4 используется в [многочисленных инновационных продуктах][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автодополнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (ускоряет разработку в редакторе, предназначенном для совместного программирования с ИИ)

GPT-4 более продвинут, чем предыдущие модели, например `gpt-3.5-turbo-instruct`. Но чтобы максимально эффективно использовать GPT-4 для задач программирования, всё равно важно давать чёткие и конкретные инструкции. В результате создание хороших запросов требует внимательности.

### Дополнительные советы по запросам

Для большего числа примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В общем, входной запрос — это главный инструмент улучшения результатов работы модели. Можно применять такие приёмы:

- **Будьте конкретнее.** Например, если хотите получить вывод в виде списка через запятую, попросите вернуть именно такой список. Если хотите, чтобы модель говорила «Я не знаю», когда ответа нет, скажите «Скажи "Я не знаю", если не знаешь ответа». Чем конкретнее инструкции, тем лучше модель сможет вам ответить.
- **Предоставляйте контекст.** Помогите модели понять общую картину вашего запроса. Это может быть дополнительная информация, примеры/демонстрации желаемого результата или объяснение цели задачи.
- **Просите модель отвечать как эксперт.** Явно попросив модель выдавать качественный ответ или писать так, как будто это сделал эксперт, можно подтолкнуть её к более высоким качествам ответов. Фразы типа «Объясни подробно» или «Опиши пошагово» помогают.
- **Побуждайте модель описывать шаги, объясняя своё мышление.** Если важно понять «почему» был получен тот или иной ответ, попросите модель включать рассуждения. Это можно сделать, просто добавив строку вроде «[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples