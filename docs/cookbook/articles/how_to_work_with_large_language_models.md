---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, которые преобразуют текст в текст. Получив входную строку текста, крупная языковая модель предсказывает, какой текст должен идти следующим.

Магия крупных языковых моделей заключается в том, что, обучаясь минимизировать ошибку предсказания на огромных объемах текста, модели в итоге усваивают концепции, полезные для этих предсказаний. Например, они учатся:

- как писать правильно
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести беседу
- как писать на многих языках
- как программировать
- и т. д.

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно встречаются в контексте вместе с другими словами, и используют эти знания, чтобы предсказать следующее наиболее вероятное слово, которое может появиться в ответ на запрос пользователя, и каждое последующее слово после него.

GPT-3 и GPT-4 лежат в основе [множества программных продуктов][OpenAI Customer Stories], включая приложения для повышения продуктивности, образовательные приложения, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входов для крупной языковой модели наиболее влиятельным является текстовый запрос (prompt).

Крупные языковые модели можно заставить выдавать результат несколькими способами:

- **Инструкция**: Скажи модели, чего ты хочешь
- **Дополнение**: Побуди модель дополнить начало того, что ты хочешь
- **Сценарий**: Дай модели ситуацию для разыгрывания
- **Демонстрация**: Покажи модели, чего ты хочешь, либо:
  - Несколькими примерами в запросе
  - Сотнями или тысячами примеров в наборе данных для дообучения

Примеры каждого подхода приведены ниже.

### Инструкционные запросы

Напиши свою инструкцию в начале запроса (или в конце, или и там, и там), и модель сделает все возможное, чтобы выполнить инструкцию и остановиться. Инструкции могут быть подробными, так что не бойся писать абзац, явно описывающий желаемый результат, только будь внимателен к количеству [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them), которое модель может обработать.

Пример инструкционного запроса:

&lt;&lt;&lt;CODE_0>>>

Вывод:

&lt;&lt;&lt;CODE_1>>>

### Пример запроса с дополнением

Запросы стиля дополнения используют то, что крупные языковые модели стараются написать текст, который, по их мнению, наиболее вероятно появится следующим. Чтобы направить модель, попробуй начать шаблон или предложение, которое модель сможет дополнить нужным тебе текстом. По сравнению с прямыми инструкциями, такое управление моделью может требовать большего внимания и экспериментов. Кроме того, модель не всегда будет знать, где остановиться, поэтому часто нужны стоп-последовательности или постобработка, чтобы отрезать текст, сгенерированный сверх желаемого результата.

Пример запроса с дополнением:

&lt;&lt;&lt;CODE_2>>>

Вывод:

&lt;&lt;&lt;CODE_3>>>

### Пример запроса со сценарием

Дать модели сценарий для роли или разыгрывания может быть полезно для сложных запросов или при поиске креативных ответов. С помощью гипотетического запроса вы задаете ситуацию, проблему или историю, а затем просите модель ответить так, будто она персонаж в этом сценарии или эксперт по данной теме.

Пример запроса со сценарием:

&lt;&lt;&lt;CODE_4>>>

Вывод:

&lt;&lt;&lt;CODE_5>>>

### Пример демонстрационного запроса (обучение с несколькими примерами)

Похожий на запросы стиля дополнения, демонстрационный запрос показывает модели, чего вы хотите. Этот подход иногда называют обучением с несколькими примерами (few-shot learning), так как модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6>>>

Вывод:

&lt;&lt;&lt;CODE_7>>>

### Пример запроса с дообучением модели

Имея достаточно обучающих примеров, можно [произвести дообучение][Fine Tuning Docs] пользовательской модели. В этом случае инструкции становятся излишними, так как модель учится выполнять задачу по предоставленным обучающим данным. Тем не менее полезно включать разделительные последовательности (например, &lt;&lt;&lt;INL_0>>>, &lt;&lt;&lt;INL_1>>> или любую строку, которая редко появляется во входных данных), чтобы сообщить модели, где заканчивается запрос и где начинаются ожидаемые ответы. Без таких разделителей существует риск, что модель продолжит развивать входной текст, а не начнёт выдавать нужный ответ.

Пример запроса для дообученной модели (которую обучали на похожих парах запроса и дополнения):

&lt;&lt;&lt;CODE_8>>>

Вывод:

&lt;&lt;&lt;CODE_9>>>

## Возможности работы с кодом

Крупные языковые модели хороши не только для текста — они отлично подходят и для кода. Модель [GPT-4][GPT-4 and GPT-4 Turbo] от OpenAI — яркий пример.

GPT-4 используется во [многих инновационных продуктах][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автодополнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (помогает писать софт быстрее в редакторе, заточенном под парное программирование с ИИ)

GPT-4 более продвинут, чем предыдущие модели вроде &lt;&lt;&lt;INL_2>>>. Но для достижения наилучших результатов с GPT-4 в задачах программирования важно давать чёткие и конкретные инструкции. Поэтому разработка хороших запросов требует тщательного подхода.

### Дополнительные советы по работе с запросами

Для большего числа примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, входной запрос — это лучший инструмент для улучшения результатов модели. Можно попробовать такие приёмы:

- **Будь конкретнее.** Например, если хочешь получить список, разделённый запятыми, попроси вывести список, разделённый запятыми. Если хочешь, чтобы модель говорила «Я не знаю», когда не знает ответа, скажи: «Ответь "Я не знаю", если не знаешь ответ». Чем конкретнее инструкции, тем лучше модель сможет ответить.
- **Предоставь контекст.** Помоги модели понять общую картину твоего запроса. Это может быть фон, примеры/демонстрации желаемого результата или объяснение цели задачи.
- **Попроси модель отвечать, как эксперт.** Явное требование к качеству или просьба ответить, будто это эксперт, могут повысить качество ответов. Такие формулировки, как «Объясни подробно» или «Опиши пошагово», зачастую эффективны.
- **Потребуй от модели описать рассуждения по шагам.** Если важно понять «почему» ответа, попроси модель включать своё рассуждение. Для этого можно просто добавить строку вроде «[Давай подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples