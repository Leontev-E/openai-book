---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, которые преобразуют текст в текст. Получив входную строку текста, крупная языковая модель предсказывает, какой текст должен идти дальше.

Магия крупных языковых моделей заключается в том, что, обучаясь минимизировать ошибку предсказания на огромных объемах текста, модели в итоге выучивают понятия, полезные для этих предсказаний. Например, они учатся:

- как правильно писать
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести разговор
- как писать на многих языках
- как кодировать
- и многому другому.

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно встречаются в контексте с другими словами, после чего используют выученное для предсказания следующего наиболее вероятного слова, которое может появиться в ответ на запрос пользователя, и каждого последующего слова.

GPT-3 и GPT-4 лежат в основе [множества программных продуктов][OpenAI Customer Stories], включая приложения для продуктивности, образовательные программы, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входных данных для крупной языковой модели самой влиятельной является текстовый запрос (prompt).

Крупные языковые модели можно заставить выдавать результат несколькими способами:

- **Инструкция**: сказать модели, чего вы хотите
- **Дополнение**: побудить модель завершить начало желаемого текста
- **Сценарий**: дать модели ситуацию для разыгрывания
- **Демонстрация**: показать модели, чего вы хотите, с помощью:
  - нескольких примеров в запросе
  - сотен или тысяч примеров в обучающем наборе данных для дообучения

Пример каждого варианта приведён ниже.

### Инструкционные запросы

Напишите вашу инструкцию в начале запроса (или в конце, или там и там), и модель постарается следовать инструкции, а затем остановится. Инструкции могут быть детальными, поэтому не бойтесь писать абзац, явно описывающий нужный вам вывод, лишь учитывайте, сколько [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) может обработать модель.

Пример инструкционного запроса:

&lt;&lt;&lt;CODE_0>>>

Результат:

&lt;&lt;&lt;CODE_1>>>

### Пример запроса дополнения

Запросы в стиле дополнения используют то, что крупные модели пытаются написать текст, который, по их мнению, наиболее вероятен дальше. Чтобы направить модель, попробуйте начать шаблон или предложение, которое будет дополнено желаемым вами выводом. По сравнению с прямыми инструкциями такой способ управления требует больше внимания и экспериментов. Кроме того, модели не всегда знают, когда остановиться, поэтому часто нужны последовательности для остановки или постобработка, чтобы обрезать текст, сгенерированный сверх желаемого.

Пример запроса дополнения:

&lt;&lt;&lt;CODE_2>>>

Результат:

&lt;&lt;&lt;CODE_3>>>

### Пример сценарного запроса

Задание модели сценария для исполнения или роли может быть полезным для сложных запросов или когда нужны творческие ответы. При использовании гипотетического запроса вы задаёте ситуацию, проблему или историю и просите модель ответить, как если бы она была персонажем в этом сценарии или экспертом по теме.

Пример сценарного запроса:

&lt;&lt;&lt;CODE_4>>>

Результат:

&lt;&lt;&lt;CODE_5>>>

### Пример демонстрационного запроса (обучение на малом количестве примеров)

Похожий на дополнения стиль, демонстрации показывают модели, что от неё хотят. Такой подход иногда называют обучением с несколькими примерами (few-shot learning), поскольку модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6>>>

Результат:

&lt;&lt;&lt;CODE_7>>>

### Пример запроса для дообученной модели

При наличии достаточного количества обучающих примеров можно [дообучить][Fine Tuning Docs] собственную модель. В этом случае инструкции уже не нужны, поскольку модель учится задаче на основе предоставленных данных. Тем не менее полезно использовать разделительные последовательности (например, &lt;&lt;&lt;INL_0>>>, &lt;&lt;&lt;INL_1>>> или любую строку, которая редко встречается во входных данных), чтобы показать модели, где заканчивается запрос и начинается вывод. Без разделителей есть риск, что модель продолжит расписывать входной текст, а не начнёт желаемый ответ.

Пример запроса для дообученной модели (настроенной на похожих парах запрос-ответ):

&lt;&lt;&lt;CODE_8>>>

Результат:

&lt;&lt;&lt;CODE_9>>>

## Возможности работы с кодом

Крупные языковые модели хороши не только с текстом — они могут отлично работать и с кодом. Модель OpenAI [GPT-4][GPT-4 and GPT-4 Turbo] — яркий пример.

GPT-4 лежит в основе [множества инновационных продуктов][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автозаполнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дополнять, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (позволяет быстрее создавать софт в редакторе, предназначенном для совместного программирования с AI)

GPT-4 более продвинут, чем модели предыдущих поколений, например, &lt;&lt;&lt;INL_2>>>. Но чтобы получить максимум от GPT-4 при решении задач по коду, всё ещё важно давать чёткие и конкретные инструкции. Поэтому проектирование хороших запросов требует тщательности.

### Дополнительные советы по запросам

Для большего числа примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, вводный запрос — лучший рычаг для улучшения результатов модели. Можно попробовать такие приёмы:

- **Будьте точнее.** Например, если хотите получить список, разделённый запятыми, скажите об этом. Если хотите, чтобы модель ответила «Не знаю», когда не знает ответа, скажите: «Скажи "Не знаю", если не знаешь ответ». Чем точнее инструкция, тем лучше модель отреагирует.
- **Добавьте контекст.** Помогите модели понять общую картину вашего запроса. Это может быть справочная информация, примеры или демонстрации желаемого или объяснение цели задачи.
- **Попросите модель отвечать, как эксперт.** Явное обращение к модели с просьбой выдать качественный или экспертный ответ может подтолкнуть её к созданию более точных и развернутых ответов. Эффективны фразы типа «Объясни подробно» или «Опиши пошагово».
- **Побудьте модель записать рассуждения пошагово.** Если важно понять «почему» ответа, попросите модель включить свои рассуждения. Это можно сделать, просто добавив строку вроде "[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)" перед ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples