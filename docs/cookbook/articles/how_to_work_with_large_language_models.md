---
lang: ru
translationOf: openai-cookbook
---

# Как работать с большими языковыми моделями

## Как работают большие языковые модели

[Большие языковые модели][Large language models Blog Post] — это функции, отображающие текст в текст. На вход подаётся строка текста, а модель предсказывает, какой текст должен идти следующим.

Магия больших языковых моделей заключается в том, что при обучении на минимизацию ошибки предсказания на огромных объёмах текста, модели в итоге учатся концепциям, полезным для этих предсказаний. Например, они учатся:

- как писать слова
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести беседу
- как писать на многих языках
- как программировать
- и многое другое

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно встречаются в контексте с другими словами, а затем используют полученные знания, чтобы предсказать следующее наиболее вероятное слово, которое может появиться в ответ на запрос пользователя, и каждое последующее слово.

GPT-3 и GPT-4 лежат в основе [многих программных продуктов][OpenAI Customer Stories], включая приложения для продуктивности, образовательные приложения, игры и многое другое.

## Как управлять большой языковой моделью

Из всех входных данных для большой языковой модели наибольшее влияние оказывает текстовый запрос (prompt).

Большие языковые модели можно стимулировать на генерацию вывода несколькими способами:

- **Инструкция**: Скажите модели, что вы хотите
- **Дополнение**: Побудите модель дополнить начало того, что вы хотите
- **Сценарий**: Дайте модели ситуацию, которую нужно разыграть
- **Демонстрация**: Покажите модели, что вы хотите, с помощью:
  - Нескольких примеров в запросе
  - Сотен или тысяч примеров в обучающем наборе для дообучения (fine-tuning)

Пример каждого из способов приведён ниже.

### Запросы в виде инструкции

Напишите инструкцию вверху запроса (или внизу, или и там, и там), и модель постарается выполнить инструкцию, а затем остановится. Инструкции могут быть подробными, поэтому не бойтесь написать целый абзац с чётким описанием желаемого результата, просто учитывайте, сколько [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) модель может обработать.

Пример запроса с инструкцией:

&lt;&lt;&lt;CODE_0>>>

Вывод:

&lt;&lt;&lt;CODE_1>>>

### Пример запроса в стиле дополнения

Запросы в стиле дополнения используют то, что большая языковая модель пытается написать текст, который, по её мнению, наиболее вероятен следующим. Чтобы направлять модель, попробуйте начать шаблон или предложение, которое модель завершит нужным вам выводом. По сравнению с прямыми инструкциями, такой способ управления моделью требует больше внимания и экспериментов. Кроме того, модель не всегда знает, где следует остановиться, поэтому часто нужны стоп-последовательности или постобработка, чтобы обрезать текст, сгенерированный сверх желаемого результата.

Пример запроса в стиле дополнения:

&lt;&lt;&lt;CODE_2>>>

Вывод:

&lt;&lt;&lt;CODE_3>>>

### Пример запроса со сценарием

Задание модели сценария для игры роли может быть полезным для сложных запросов или при поиске творческих ответов. Используя гипотетический запрос, вы создаёте ситуацию, задачу или рассказ, а затем просите модель ответить, как если бы она была персонажем в этой ситуации или экспертом по теме.

Пример запроса со сценарием:

&lt;&lt;&lt;CODE_4>>>

Вывод:

&lt;&lt;&lt;CODE_5>>>

### Пример демонстрационного запроса (few-shot обучение)

Похожие на запросы дополнения, демонстрации показывают модели, что вы хотите, чтобы она сделала. Такой подход иногда называют few-shot обучением, так как модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6>>>

Вывод:

&lt;&lt;&lt;CODE_7>>>

### Пример запроса для модели с дообучением

Имея достаточно обучающих примеров, вы можете [дообучить][Fine Tuning Docs] кастомную модель. В этом случае инструкции становятся ненужными, так как модель выучит задачу из предоставленных данных. Однако полезно включать разделители (например, &lt;&lt;&lt;INL_0>>>, &lt;&lt;&lt;INL_1>>>, или любую строку, которая редко встречается в ваших входных данных), чтобы обозначить, где заканчивается запрос и начинается вывод. Без разделителей модель может продолжить развивать входной текст, а не начать нужный вам ответ.

Пример запроса для модели с дообучением (с парами запрос-ответ, похожими на те, на которых её обучали):

&lt;&lt;&lt;CODE_8>>>

Вывод:

&lt;&lt;&lt;CODE_9>>>

## Возможности работы с кодом

Большие языковые модели полезны не только для работы с текстом — они отлично справляются и с кодом. Яркий пример — модель OpenAI [GPT-4][GPT-4 and GPT-4 Turbo].

GPT-4 лежит в основе [множества инновационных продуктов][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автодополнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (помогает быстрее создавать софт в редакторе, предназначенном для парного программирования с ИИ)

GPT-4 более продвинута, чем предыдущие модели вроде &lt;&lt;&lt;INL_2>>>. Но чтобы получить от GPT-4 лучший результат в задачах, связанных с кодированием, важно давать чёткие и конкретные инструкции. Поэтому создание хороших запросов требует особого внимания.

### Дополнительные советы по созданию запросов

Для большего количества примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, самый мощный рычаг для улучшения вывода — это входной запрос. Можно попробовать такие приёмы:

- **Будьте более конкретны** Например, если хотите получить список через запятую, попросите именно список через запятую. Если хотите, чтобы модель говорила «Я не знаю», когда ответ не известен, скажите: «Говори "Я не знаю", если не знаешь ответа». Чем конкретнее ваши инструкции, тем лучше отреагирует модель.
- **Дайте контекст** Помогите модели понять общую картину вашего запроса. Это может быть фон, примеры/демонстрации того, что вы хотите, или объяснение цели задачи.
- **Попросите модель ответить, как эксперт.** Явно попросите модель создать высококачественный ответ или ответить, как если бы он был написан экспертом. Фразы вроде «Объясни подробно» или «Опиши шаг за шагом» работают эффективно.
- **Побуждайте модель описывать серию шагов с объяснением рассуждений.** Если важно понять «почему» за ответом, попросите модель включать свои рассуждения. Это можно сделать, добавив строку вроде «[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед каждым ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples  
