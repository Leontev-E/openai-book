---
lang: ru
translationOf: openai-cookbook
---

# Как работать с крупными языковыми моделями

## Как работают крупные языковые модели

[Крупные языковые модели][Large language models Blog Post] — это функции, которые отображают текст в текст. Получив входную строку текста, крупная языковая модель предсказывает текст, который должен идти следующим.

Магия крупных языковых моделей в том, что тренируясь минимизировать ошибку предсказания на огромных объёмах текста, модели в итоге учатся понятиям, полезным для этих предсказаний. Например, они учатся:

- как правильно писать
- как работает грамматика
- как перефразировать
- как отвечать на вопросы
- как вести диалог
- как писать на многих языках
- как программировать
- и так далее.

Они делают это, «читая» большое количество существующего текста и изучая, как слова обычно появляются в контексте с другими словами, и используют полученные знания, чтобы предсказать следующее наиболее вероятное слово, которое может появиться в ответ на запрос пользователя, и далее каждое следующее слово.

GPT-3 и GPT-4 лежат в основе [многих программных продуктов][OpenAI Customer Stories], включая приложения для повышения продуктивности, образовательные приложения, игры и многое другое.

## Как управлять крупной языковой моделью

Из всех входных данных крупной языковой модели наиболее влиятельным является текстовый запрос (prompt).

Крупные языковые модели можно заставить выдавать результат несколькими способами:

- **Инструкция**: Скажите модели, чего вы хотите
- **Завершение**: Побудите модель дополнить начало того, чего вы хотите
- **Сценарий**: Дайте модели ситуацию для разыгрывания
- **Демонстрация**: Покажите модели, что вы хотите, с помощью:
  - Нескольких примеров в запросе
  - Сотен или тысяч примеров в обучающем датасете для дообучения (fine-tuning)

Пример каждого способа приведён ниже.

### Инструкции (instruction prompts)

Напишите вашу инструкцию в начале запроса (или в конце, или в обоих местах), и модель постарается следовать этой инструкции и остановится. Инструкции могут быть подробными, так что не бойтесь писать абзац, явно описывающий желаемый результат, но при этом учитывайте, сколько [токенов](https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them) модель может обработать.

Пример инструкции:

&lt;&lt;&lt;CODE_0>>>

Вывод:

&lt;&lt;&lt;CODE_1>>>

### Пример запроса на завершение (completion prompt example)

Запросы типа completion используют то, как крупные языковые модели пытаются написать текст, который, по их мнению, наиболее вероятно должен идти следующим. Чтобы направить модель, попробуйте начать шаблон или предложение, которое будет завершено текстом, который вы хотите получить. По сравнению с прямыми инструкциями, такой способ управления моделью требует большего внимания и экспериментов. Кроме того, модель может не знать, где остановиться, поэтому часто нужны стоп-последовательности или постобработка, чтобы обрезать текст, сгенерированный после желаемого результата.

Пример запроса на завершение:

&lt;&lt;&lt;CODE_2>>>

Вывод:

&lt;&lt;&lt;CODE_3>>>

### Пример запроса со сценарием (scenario prompt example)

Давать модели сценарий для исполнения или роль, которую нужно сыграть, полезно для сложных запросов или когда требуется творческий ответ. Используя гипотетический запрос, вы задаёте ситуацию, проблему или историю, а затем просите модель ответить так, как будто она персонаж в этой ситуации или эксперт по теме.

Пример запроса со сценарием:

&lt;&lt;&lt;CODE_4>>>

Вывод:

&lt;&lt;&lt;CODE_5>>>

### Пример демонстрационного запроса (few-shot learning)

Похожий на completion-стиль запросов, демонстрации показывают модели, что вы хотите, чтобы она сделала. Этот подход иногда называют обучения по нескольким примерам (few-shot learning), так как модель учится на нескольких примерах, приведённых в запросе.

Пример демонстрационного запроса:

&lt;&lt;&lt;CODE_6>>>

Вывод:

&lt;&lt;&lt;CODE_7>>>

### Пример запроса для тонкой настройки (fine-tuned prompt example)

Имея достаточно обучающих примеров, вы можете [дообучить][Fine Tuning Docs] собственную модель. В этом случае инструкции становятся излишними, так как модель учится выполнять задачу по предоставленным данным. Однако полезно включать разделители (например, &lt;&lt;&lt;INL_0>>>, &lt;&lt;&lt;INL_1>>> или любую строку, которая редко встречается во входных данных), чтобы указать модели, где заканчивается запрос и начинается вывод. Без разделителей модель может продолжать развивать входной текст, вместо того, чтобы начать нужный ответ.

Пример запроса для тонко настроенной модели (которая была обучена на похожих парах запрос-ответ):

&lt;&lt;&lt;CODE_8>>>

Вывод:

&lt;&lt;&lt;CODE_9>>>

## Возможности работы с кодом

Крупные языковые модели хороши не только с текстом — они отлично справляются и с кодом. Примером служит модель OpenAI [GPT-4][GPT-4 and GPT-4 Turbo].

GPT-4 лежит в основе [множества инновационных продуктов][OpenAI Customer Stories], включая:

- [GitHub Copilot] (автодополнение кода в Visual Studio и других IDE)
- [Replit](https://replit.com/) (может дописывать, объяснять, редактировать и генерировать код)
- [Cursor](https://cursor.sh/) (позволяет быстрее разрабатывать ПО в редакторе, спроектированном для совместного программирования с ИИ)

GPT-4 более продвинут, чем предыдущие модели, такие как &lt;&lt;&lt;INL_2>>>. Но чтобы получить максимум от GPT-4 для задач программирования, всё равно важно давать чёткие и конкретные инструкции. В результате создание хороших запросов может требовать больше усилий.

### Дополнительные советы по запросам

Для дополнительных примеров запросов посетите [OpenAI Examples][OpenAI Examples].

В целом, входной запрос — самый лучший рычаг для улучшения ответов модели. Вы можете попробовать такие приёмы, как:

- **Будьте конкретны** Например, если вы хотите получить список, разделённый запятыми, попросите вернуть именно такой список. Если хотите, чтобы модель говорила «Я не знаю», когда не знает ответа, скажите: «Скажите „Я не знаю“, если вы не знаете ответ». Чем точнее ваши инструкции, тем лучше модель сможет ответить.
- **Предоставляйте контекст** Помогите модели понять общую картину вашего запроса. Это может быть фон, примеры/демонстрации того, что вы хотите, или объяснение цели задачи.
- **Попросите модель отвечать как эксперт.** Явно просите модель создавать качественные ответы или писать так, будто она эксперт. Это может побудить модель выдавать более качественные ответы, которые, по её мнению, напишет эксперт. Фразы типа «Объясните подробно» или «Опишите пошагово» могут быть эффективными.
- **Подсказывайте модели записывать последовательность шагов с объяснением рассуждений.** Если важно понять «почему» ответа, попросите модель включать объяснение логики. Это можно сделать просто добавляя строку вроде «[Давайте подумаем шаг за шагом](https://arxiv.org/abs/2205.11916)» перед каждым ответом.

[Fine Tuning Docs]: https://platform.openai.com/docs/guides/fine-tuning  
[OpenAI Customer Stories]: https://openai.com/customer-stories  
[Large language models Blog Post]: https://openai.com/research/better-language-models  
[GitHub Copilot]: https://github.com/features/copilot/  
[GPT-4 and GPT-4 Turbo]: https://platform.openai.com/docs/models/gpt-4-and-gpt-4-turbo  
[GPT3 Apps Blog Post]: https://openai.com/blog/gpt-3-apps/  
[OpenAI Examples]: https://platform.openai.com/examples  
